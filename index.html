<!doctype html>
<html>
<head>
    <title>PI fraction 2.0</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body style="width: 100%; margin: 0%; display:flex; justify-content: center; margin-top: 5px;">
<table>
    <tr>
        <th style="display: flex; justify-content: center;">
            <canvas id="canvas" width="500" height="500">
                Этот элемент не поддерживается.
            </canvas>
        </th>
    </tr>
    <tr>
        <th>
            <div class="mb-1" style="text-align: center; font-size: 30px;">
                Результат: <content id="ang1">-</content> (<content id="ang2">-</content>)°
            </div>
            <div class="input-group mb-1">
                  <input type="number" class="form-control" placeholder="Числитель дроби" id="up" onkeyup="calc()" onchange="calc()">
                  <div class="input-group-append">
                    <span class="input-group-text">π</span>
                  </div>
            </div>
            <div class="input-group mb-3">
                  <input type="number" class="form-control" placeholder="Знаменатель дроби" id="down" onkeyup="calc()" onchange="calc()">
            </div>

        </th>
    </tr>
</table>
<script>
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");

function degToRad (deg) { return deg / 180 * Math.PI; }

function draw(angle){
	ctx.clearRect(0, 0, canvas.width, canvas.height);

	ctx.beginPath();
	ctx.moveTo(250,500);
	ctx.lineTo(250, 0);
	ctx.stroke();
	ctx.lineTo(245, 5);
	ctx.lineTo(255, 5);
	ctx.lineTo(250, 0);
	ctx.fillStyle = "black";
	ctx.fill();
	ctx.stroke();


    ctx.beginPath();
	ctx.moveTo(0,250);
	ctx.lineTo(500, 250);
	ctx.stroke();
	ctx.lineTo(495, 245);
	ctx.lineTo(495, 255);
	ctx.lineTo(500, 250);
	ctx.fillStyle = "black";
	ctx.fill();
   	 ctx.stroke();
	ctx.closePath();

	ctx.font = "18px Arial";
	ctx.fillText("y",234,12);
	ctx.fillText("x",490,268);
	ctx.fillText("0",454,245);


	ctx.moveTo(250,250);
	ctx.arc(250,250,200,0,Math.PI*2,true);
	ctx.stroke();

	x1 = (1 / (1 + Math.tan(degToRad(angle))**2))**0.5;
	x2 = -1 * (1 / (1 + Math.tan(degToRad(angle))**2))**0.5;
	y1 = (1-x1**2)**0.5;
	y2 = -1*(1-x2**2)**0.5;
	ctx.beginPath();
	if (angle <= 90){
		ctx.arc(250+x1*200,250+y2*200,5,0,Math.PI*2,true);}
	else if(angle <= 180){
		ctx.arc(250+x2*200,250+y2*200,5,0,Math.PI*2,true);}
	else if(angle <= 270){
		ctx.arc(250+x2*200,250+y1*200,5,0,Math.PI*2,true);}
	else if(angle <= 360){
		ctx.arc(250+x1*200,250+y1*200,5,0,Math.PI*2,true);}
	ctx.fillStyle = "red";
	ctx.fill()
	ctx.stroke();}

function calc(){
    x = Number(document.getElementById('up').value);
    y = Number(document.getElementById('down').value);
    if (y != 0){
    angle = ((180 / y) * x) % 360
    document.getElementById('ang1').innerHTML = angle;
    if (angle >= 0){
        draw(angle);
        document.getElementById('ang2').innerHTML = angle - 360;}
    else{
        draw(360 + angle);
        document.getElementById('ang2').innerHTML = angle + 360;}
    }
    else{
        document.getElementById('ang1').innerHTML = "-";
        document.getElementById('ang2').innerHTML = "-";
        draw(1/0);
    }

}
draw(1/0);
</script>
</body>
</html>
